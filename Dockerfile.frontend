# Build the React frontend
FROM node:16-alpine as build-step
COPY /frontend .
RUN yarn install
RUN yarn build
# The node image is no longer needed, so start afresh with the smaller nginx image
FROM nginx:stable-alpine
# Copy the /build folder created after yarn build to /usr/share/nginx/html
COPY --from=build-step /build /usr/share/nginx/html
# Replace the default configuration file
COPY /default.conf /etc/nginx/conf.d/default.conf